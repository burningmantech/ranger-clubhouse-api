#!/bin/sh
#
# Deploy Docker image.
#

. "$(dirname "$0")/.common.sh";

version="master";

host="raw.githubusercontent.com";
repo="burningmantech/ranger-deploy";
path="bin/deploy_aws_ecs";

script_url="https://${host}/${repo}/${version}/${path}";

export LOCAL_IMAGE_NAME="${image_name}";
export AWS_ECR_IMAGE_NAME="${AWS_ECR_IMAGE_REPOSITORY}";

deploy_cmd="$(mktemp)";

curl --silent "${script_url}" --output "${deploy_cmd}";

env;

sh -x "${deploy_cmd}" --profile="clubhouse-api" "${@}";

rm "${deploy_cmd}";
