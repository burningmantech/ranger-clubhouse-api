#!/bin/sh
#
# Dispatcher for Travis CI
#

set -e
set -u

wd="$(cd "$(dirname "$0")/.." && pwd)";

echo "Environment:";
env;

case "${TRAVIS_ACTION:=}" in
    "lint")
        "${wd}/bin/test_lint" .;
        ;;
    "docker")
        "${wd}/bin/build";
        "${wd}/bin/test_docker";
        ;;
    "deploy")
        "${wd}/bin/build";
        "${wd}/bin/deploy";
        ;;
    *)
        echo "Unknown Travis action: ${TRAVIS_ACTION}";
        exit 1;
        ;;
esac;
